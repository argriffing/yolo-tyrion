\documentclass{article}

\usepackage[authoryear,round]{natbib}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

% small margins for huge matrices
%\usepackage[margin=0.1in]{geometry}
\usepackage[a4paper]{geometry}

\usepackage{float}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{hyperref}


\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{trick}[thm]{Trick}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{prop}[thm]{Property}

\usetikzlibrary{decorations.pathreplacing}

% the default max matrix dimensions in amsmath is ten
\setcounter{MaxMatrixCols}{20}

% this is copied from the internet
% and its purpose is to compensate for bad vertical spacing in amsmath pmatrix
% by letting you do things like \begin{pmatrix}[1.5]
%\makeatletter
%\renewcommand*\env@matrix[1][\arraystretch]{%
	  %\edef\arraystretch{#1}%
	    %\hskip -\arraycolsep
	      %\let\@ifnextchar\new@ifnextchar
	        %\array{*\c@MaxMatrixCols c}}
		%\makeatother


\begin{document}

\title
{
	Decompositions of rate matrices of continuous-time Moran
	models of allele frequency change in tiny populations,
	for specific weird mutational structures
}
% \author{Alexander Griffing}
\maketitle

\section{Jordan decompositions for tiny populations of size $N$}

In each of these examples,
the mutation rate is scaled so that the equilibrium distribution
of the compound state \{AB + Ab\} is discrete uniform.

\subsection{$N=1$}

When the population size is $1$, only the mutation process matters,
and genetic drift does not affect the rate matrix.
The population genetic rate matrix is just the mutation rate matrix.

Population genetic rate matrix for $N = 1$:
\begin{equation}
	Q =
	\begin{pmatrix}
		-2 & 1 & 1 & 0 \\
		1 & -2 & 0 & 1 \\
		1 & 0 & -2 & 1 \\
		0 & 1 & 1 & -2
	\end{pmatrix}
\end{equation}

Jordan decomposition:
\begin{equation}
	Q =
	\begin{pmatrix}
		1 & -1 & 0 & 1 \\
		-1 & 0 & -1 & 1 \\
		-1 & 0 & 1 & 1 \\
		1 & 1 & 0 & 1
	\end{pmatrix} \\
	\begin{pmatrix}
		-4 & 0 & 0 & 0 \\
		0 & -2 & 0 & 0 \\
		0 & 0 & -2 & 0 \\
		0 & 0 & 0 & 0
	\end{pmatrix}
	\begin{pmatrix}
		1/4 & -1/4 & -1/4 & 1/4 \\
		-1/2 & 0 & 0 & 1/2 \\
		0 & -1/2 & 1/2 & 0 \\
		1/4 & 1/4 & 1/4 & 1/4
	\end{pmatrix}
\end{equation}


\subsection{$N = 2$}

Population genetic rate matrix for $N = 2$:
\begin{equation}
	Q =
	\begin{pmatrix}
		-4 & 2 & 0 & 2 & 0 & 0 & 0 & 0 & 0 & 0 \\
		2 & -6 & 2 & 0 & 1 & 0 & 1 & 0 & 0 & 0 \\
		0 & 2 & -4 & 0 & 0 & 0 & 0 & 2 & 0 & 0 \\
		2 & 0 & 0 & -6 & 1 & 2 & 1 & 0 & 0 & 0 \\
		0 & 1 & 1 & 1 & -6 & 1 & 0 & 1 & 1 & 0 \\
		0 & 0 & 0 & 2 & 0 & -4 & 0 & 0 & 2 & 0 \\
		1 & 1 & 0 & 1 & 0 & 0 & -6 & 1 & 1 & 1 \\
		0 & 0 & 2 & 0 & 1 & 0 & 1 & -6 & 0 & 2 \\
		0 & 0 & 0 & 0 & 1 & 2 & 1 & 0 & -6 & 2 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 2 & -4
	\end{pmatrix}
\end{equation}

Jordan decomposition $Q = P J P^{-1}$:
\begin{align}
	P &=
	\begin{pmatrix}
		2 & -1 & 0 & 1 & 0 & 0 & 1 & -1 & 0 & 1 \\
		-3 & 0 & -1 & 0 & 1 & 0 & 0 & 0 & -1 & 1 \\
		2 & 1 & 1 & 1 & 0 & 0 & -1 & 1 & -2 & 1 \\
		-3 & 2 & 1 & -1 & -1 & 0 & 0 & -1 & 1 & 1 \\
		2 & 0 & 0 & -4 & 0 & -1 & -1 & 0 & 0 & 1 \\
		2 & -1 & -1 & 1 & 0 & 0 & -1 & -1 & 2 & 1 \\
		2 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 1 \\
		-3 & -2 & -1 & -1 & -1 & 0 & 0 & 1 & -1 & 1 \\
		-3 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 1 & 1 \\
		2 & 1 & 0 & 1 & 0 & 0 & 1 & 1 & 0 & 1
	\end{pmatrix} \\
	J &=
	\begin{pmatrix}
		-10 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & -8 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & -8 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & -6 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & -6 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & -6 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & -4 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & -2 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -2 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
	\end{pmatrix} \\
	P^{-1} &=
	\begin{pmatrix}
		1/40 & -1/20 & 1/40 & -1/20 & 1/20 & 1/40 & 1/20 & -1/20 & -1/20 & 1/40 \\
		-1/6 & 1/6 & 0 & 1/6 & 0 & 0 & 0 & -1/6 & -1/6 & 1/6 \\
		1/6 & -1/3 & 1/6 & 0 & 0 & -1/6 & 0 & 0 & 1/3 & -1/6 \\
		1/12 & 0 & 1/12 & 0 & -1/6 & 1/12 & -1/6 & 0 & 0 & 1/12 \\
		-1/24 & 1/4 & -1/24 & -1/4 & 1/12 & -1/24 & 1/12 & -1/4 & 1/4 & -1/24 \\
		-5/12 & 0 & 1/12 & 0 & -1/6 & 1/12 & 5/6 & 0 & 0 & -5/12 \\
		1/4 & 0 & -1/4 & 0 & 0 & -1/4 & 0 & 0 & 0 & 1/4 \\
		-1/3 & -1/6 & 0 & -1/6 & 0 & 0 & 0 & 1/6 & 1/6 & 1/3 \\
		-1/6 & -1/6 & -1/6 & 0 & 0 & 1/6 & 0 & 0 & 1/6 & 1/6 \\
		7/60 & 1/10 & 7/60 & 1/10 & 1/15 & 7/60 & 1/15 & 1/10 & 1/10 & 7/60
	\end{pmatrix}
\end{align}


\section{$N = 3$}

Population genetic rate matrix for $N = 3$:
\begin{equation}
	Q =
	\left(
	\begin{smallmatrix}
		-6 & 3 & 0 & 0 & 3 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		3 & -10 & 4 & 0 & 0 & 2 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 4 & -10 & 3 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 2 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 3 & -6 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 3 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		3 & 0 & 0 & 0 & -10 & 2 & 0 & 4 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 2 & 1 & 0 & 2 & -12 & 2 & 1 & 2 & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 1 & 2 & 0 & 2 & -10 & 0 & 2 & 0 & 0 & 0 & 1 & 0 & 2 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 0 & 0 & 4 & 0 & 0 & -10 & 1 & 3 & 0 & 0 & 0 & 2 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 0 & 0 & 0 & 2 & 2 & 1 & -10 & 2 & 0 & 0 & 0 & 0 & 2 & 1 & 0 & 0 & 0 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 3 & 0 & -6 & 0 & 0 & 0 & 0 & 0 & 3 & 0 & 0 & 0 & 0\\
		2 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & -10 & 2 & 0 & 2 & 0 & 0 & 2 & 0 & 0 & 0\\
		0 & 1 & 2 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 2 & -12 & 2 & 0 & 1 & 0 & 2 & 1 & 0 & 0\\
		0 & 0 & 0 & 3 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 2 & -10 & 0 & 0 & 0 & 0 & 4 & 0 & 0\\
		0 & 0 & 0 & 0 & 1 & 1 & 0 & 2 & 0 & 0 & 2 & 0 & 0 & -12 & 1 & 2 & 2 & 0 & 1 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 2 & 0 & 2 & 0 & 0 & 1 & 1 & 1 & -12 & 1 & 0 & 2 & 2 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 3 & 0 & 0 & 0 & 2 & 0 & -10 & 0 & 0 & 4 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 2 & 0 & 2 & 0 & 0 & -10 & 1 & 1 & 2\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 4 & 0 & 2 & 0 & 1 & -10 & 0 & 3\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2 & 4 & 1 & 0 & -10 & 3\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 3 & 3 & -6
	\end{smallmatrix}
	\right)
\end{equation}

\newgeometry{left=1cm,right=1cm}
Jordan decomposition $Q = P J P^{-1}$:
\begin{align}
	P &=
	\left(
	\begin{smallmatrix}
		1 & -18 & 0 & 54 & 0 & 0 & -2 & 0 & 0 & 0 & 3 & -6 & 0 & 2 & 0 & 0 & 3 & -3 & 0 & 1 \\
		-2 & 0 & -10 & 0 & 1 & 0 & 0 & -2 & 0 & 0 & -2 & 0 & -2 & 0 & 1 & 0 & 1 & 0 & -1 & 1 \\
		2 & 25 & 15 & 32 & -1 & 16 & -3 & 1 & 0 & 0 & -2 & 3 & -1 & 0 & 1 & 0 & -1 & 3 & -2 & 1 \\
		-1 & -27 & -9 & -78 & 0 & -12 & -1 & -1 & 0 & 0 & 3 & 3 & 3 & 2 & 0 & 0 & -3 & 6 & -3 & 1 \\
		-2 & 60 & 10 & -144 & -1 & 0 & 4 & 2 & 0 & 0 & -2 & 4 & 2 & 0 & -1 & 0 & 1 & -4 & 1 & 1 \\
		2 & -20 & 0 & -145 & 0 & -41 & 9 & 0 & 1 & 0 & -2 & 4 & 0 & -3 & 0 & -1 & -1 & -1 & 0 & 1 \\
		-1 & -9 & -3 & 88 & 0 & 26 & 9 & 9 & 0 & 2 & 3 & 1 & 1 & -4 & 0 & -2 & -3 & 2 & -1 & 1 \\
		2 & -65 & -15 & 176 & 1 & 16 & -5 & -1 & 0 & 0 & -2 & 5 & 1 & 0 & -1 & 0 & -1 & -5 & 2 & 1 \\
		-1 & 9 & 3 & 88 & 0 & 26 & -9 & -9 & 0 & -2 & 3 & -1 & -1 & -4 & 0 & -2 & -3 & -2 & 1 & 1 \\
		-1 & 27 & 9 & -78 & 0 & -12 & 1 & 1 & 0 & 0 & 3 & -3 & -3 & 2 & 0 & 0 & -3 & -6 & 3 & 1 \\
		1 & -6 & 0 & 0 & 0 & 18 & 0 & 0 & -2 & 0 & 3 & -2 & 0 & 0 & 0 & 2 & 3 & -1 & 0 & 1 \\
		-2 & -30 & -10 & 9 & 0 & -27 & 0 & 0 & 0 & -1 & -2 & -2 & -2 & -1 & 0 & 1 & 1 & 2 & -1 & 1 \\
		2 & 65 & 15 & 176 & 1 & 16 & 5 & 1 & 0 & 0 & -2 & -5 & -1 & 0 & -1 & 0 & -1 & 5 & -2 & 1 \\
		-2 & 30 & 10 & 9 & 0 & -27 & 0 & 0 & 0 & 1 & -2 & 2 & 2 & -1 & 0 & 1 & 1 & -2 & 1 & 1 \\
		2 & 20 & 0 & -145 & 0 & -41 & -9 & 0 & -1 & 0 & -2 & -4 & 0 & -3 & 0 & -1 & -1 & 1 & 0 & 1 \\
		2 & -25 & -15 & 32 & -1 & 16 & 3 & -1 & 0 & 0 & -2 & -3 & 1 & 0 & 1 & 0 & -1 & -3 & 2 & 1 \\
		1 & 6 & 0 & 0 & 0 & 18 & 0 & 0 & 2 & 0 & 3 & 2 & 0 & 0 & 0 & 2 & 3 & 1 & 0 & 1 \\
		-2 & -60 & -10 & -144 & -1 & 0 & -4 & -2 & 0 & 0 & -2 & -4 & -2 & 0 & -1 & 0 & 1 & 4 & -1 & 1 \\
		-2 & 0 & 10 & 0 & 1 & 0 & 0 & 2 & 0 & 0 & -2 & 0 & 2 & 0 & 1 & 0 & 1 & 0 & 1 & 1 \\
		1 & 18 & 0 & 54 & 0 & 0 & 2 & 0 & 0 & 0 & 3 & 6 & 0 & 2 & 0 & 0 & 3 & 3 & 0 & 1
	\end{smallmatrix}
	\right) \\
	J &=
	\left(
	\begin{smallmatrix}
		-18 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & -16 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & -16 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & -14 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & -14 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & -14 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & -12 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & -12 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -12 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -12 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -10 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -8 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -8 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -6 & 0 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -6 & 0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -6 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -4 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -2 & 0 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -2 & 0 \\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
	\end{smallmatrix}
	\right) \\
	P^{-1} &=
	\frac{1}{20160}
	\left(
	\begin{smallmatrix}
180 & -540 & 540 & -180 & -540 & 1080 & -540 & 540 & -540 & -180 & 540 & -1080 & 540 & -1080 & 1080 & 540 & 540 & -540 & -540 & 180 \\
-45 & 90 & -45 & 0 & 90 & -90 & 0 & -45 & 0 & 0 & -45 & 0 & 45 & 0 & 90 & 45 & 45 & -90 & -90 & 45 \\
135 & -360 & 315 & -90 & -180 & 270 & -90 & -45 & 90 & 90 & 135 & -180 & 45 & 180 & -270 & -315 & -135 & 180 & 360 & -135 \\
19 & -19 & 9 & -9 & -19 & -18 & 9 & 9 & 9 & -9 & -19 & 38 & 9 & 38 & -18 & 9 & -19 & -19 & -19 & 19 \\
-1368 & 3888 & -3168 & 648 & -1152 & 1296 & -648 & 1872 & -648 & 648 & 1368 & -2736 & 1872 & -2736 & 1296 & -3168 & 1368 & -1152 & 3888 & -1368 \\
-83 & 83 & 27 & -27 & 83 & -54 & 27 & 27 & 27 & -27 & 83 & -166 & 27 & -166 & -54 & 27 & 83 & 83 & 83 & -83 \\
-126 & 0 & -378 & 0 & 0 & 756 & 0 & -378 & 0 & 0 & 378 & 0 & 378 & 0 & -756 & 378 & -378 & 0 & 0 & 126 \\
126 & -756 & 378 & -252 & 756 & -756 & 756 & 378 & -756 & 252 & -378 & 1512 & -378 & -1512 & 756 & -378 & 378 & -756 & 756 & -126 \\
1638 & 0 & -126 & 0 & 0 & 252 & 0 & -126 & 0 & 0 & -4914 & 0 & 126 & 0 & -252 & 126 & 4914 & 0 & 0 & -1638 \\
0 & 3528 & 0 & -504 & -3528 & 0 & 1512 & 0 & -1512 & 504 & 0 & -7056 & 0 & 7056 & 0 & 0 & 0 & 3528 & -3528 & 0 \\
504 & -504 & -504 & 504 & -504 & 0 & 504 & -504 & 504 & 504 & 504 & 0 & -504 & 0 & 0 & -504 & 504 & -504 & -504 & 504 \\
-735 & 210 & 525 & 0 & 210 & 210 & 0 & 525 & 0 & 0 & 105 & 0 & -525 & 0 & -210 & -525 & -105 & -210 & -210 & 735 \\
735 & -1260 & -945 & 1470 & 840 & -210 & -210 & -105 & 210 & -1470 & -105 & -420 & 105 & 420 & 210 & 945 & 105 & -840 & 1260 & -735 \\
945 & 315 & 315 & 945 & 315 & -630 & -945 & 315 & -945 & 945 & -945 & -630 & 315 & -630 & -630 & 315 & -945 & 315 & 315 & 945 \\
0 & 2520 & 2520 & 0 & -2520 & 0 & 0 & -2520 & 0 & 0 & 0 & 0 & -2520 & 0 & 0 & 2520 & 0 & -2520 & 2520 & 0 \\
-2835 & -945 & 315 & 945 & -945 & -630 & -945 & 315 & -945 & 945 & 2835 & 1890 & 315 & 1890 & -630 & 315 & 2835 & -945 & -945 & -2835 \\
1368 & 432 & -432 & -1368 & 432 & 144 & -72 & -432 & -72 & -1368 & 72 & -144 & -432 & -144 & 144 & -432 & 72 & 432 & 432 & 1368 \\
-1536 & -960 & -528 & 0 & -960 & -384 & 0 & -528 & 0 & 0 & -192 & 0 & 528 & 0 & 384 & 528 & 192 & 960 & 960 & 1536 \\
-3072 & -2448 & -2016 & -1536 & -1392 & -768 & -192 & -96 & 192 & 1536 & -384 & -384 & 96 & 384 & 768 & 2016 & 384 & 1392 & 2448 & 3072 \\
1368 & 1152 & 1152 & 1368 & 1152 & 720 & 648 & 1152 & 648 & 1368 & 648 & 720 & 1152 & 720 & 720 & 1152 & 648 & 1152 & 1152 & 1368
	\end{smallmatrix}
	\right)
\end{align}
\restoregeometry


\end{document}
